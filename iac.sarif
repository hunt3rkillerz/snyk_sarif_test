{"$schema":"https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json","version":"2.1.0","runs":[{"tool":{"driver":{"name":"Snyk-IaC","rules":[{"id":"SNYK-CC-TF-50","shortDescription":{"text":"Resource is publically accessible"},"fullDescription":{"text":"AWS resource is publicly accessible"},"help":{"markdown":"## Overview\nAWS resource is publicly accessible\n\n## Impact\n\nIncreases attack vector reachability\n\n## Remediation\n\nSet `publicly_accessible` attribute to `false`","text":""},"defaultConfiguration":{"level":"error"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-53","shortDescription":{"text":"Non-Encrypted root block device"},"fullDescription":{"text":"The root block device for ec2 instance is not encrypted"},"help":{"markdown":"## Overview\nThe root block device for ec2 instance is not encrypted\n\n## Impact\n\nThat should someone gain unauthorized access to the data they would be able to read the contents.\n\n## Remediation\n\nSet `root_block_device.encrypted` attribute to `true`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-56","shortDescription":{"text":"Missing description"},"fullDescription":{"text":"The description field is missing in the security group"},"help":{"markdown":"## Overview\nThe description field is missing in the security group\n\n## Impact\n\nIncreases the security management overhead\n\n## Remediation\n\nSet `description` attribute to meaningful statement","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-72","shortDescription":{"text":"Rule allows open egress"},"fullDescription":{"text":"The security group rule allows open egress"},"help":{"markdown":"## Overview\nThe security group rule allows open egress\n\n## Impact\n\nOpen egress can be used to exfiltrate data to unauthorized destinations, and enable access to potentially malicious resources\n\n## Remediation\n\nSet `cidr_blocks` attribute to specific ranges e.g. `192.168.1.0/24`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-1","shortDescription":{"text":"Security Group allows open ingress"},"fullDescription":{"text":"That inbound traffic is allowed to a resource from any source instead of a restricted range"},"help":{"markdown":"## Overview\nThat inbound traffic is allowed to a resource from any source instead of a restricted range\n\n## Impact\n\nThat potentially everyone can access your resource\n\n## Remediation\n\nUpdating the `cidr_block` attribute with a more restrictive IP range or a specific IP address to ensure traffic can only come from known sources. ","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-4","shortDescription":{"text":"Unencrypted S3 Bucket"},"fullDescription":{"text":"That by default S3 buckets do not encrypt the objects that are stored."},"help":{"markdown":"## Overview\nThat by default S3 buckets do not encrypt the objects that are stored.\n\n## Impact\n\nThat should someone gain unauthorized access to the data they would be able to read the contents.\n\n## Remediation\n\nAdding the `server_side_encryption_configuration` block and associated attributes to configure your encryption key and algorithm.","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-45","shortDescription":{"text":"S3 server access logging is disabled"},"fullDescription":{"text":"The s3 access logs will not be collected"},"help":{"markdown":"## Overview\nThe s3 access logs will not be collected\n\n## Impact\n\nThere will be no audit trail of access to s3 objects\n\n## Remediation\n\nAdd `logging` block attribute","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-73","shortDescription":{"text":"AWS Security Group allows open egress"},"fullDescription":{"text":"The inline security group rule allows open egress"},"help":{"markdown":"## Overview\nThe inline security group rule allows open egress\n\n## Impact\n\nOpen egress can be used to exfiltrate data to unauthorized destinations, and enable access to potentially malicious resources\n\n## Remediation\n\nSet `egress.cidr_blocks` attribute to specific ranges e.g. `192.168.1.0/24`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-61","shortDescription":{"text":"ECR image scanning is disabled"},"fullDescription":{"text":"The ECR image scan for known vulnerabilities is disabled"},"help":{"markdown":"## Overview\nThe ECR image scan for known vulnerabilities is disabled\n\n## Impact\n\nThe known vulnerabilities will not be automatically discovered\n\n## Remediation\n\nSet `image_scanning_configuration.scan_on_push` attribute to `true`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-48","shortDescription":{"text":"Loadbalancer is internet facing"},"fullDescription":{"text":"Loadbalancer is internet facing"},"help":{"markdown":"## Overview\nLoadbalancer is internet facing\n\n## Impact\n\nIncreases attack vector reachability\n\n## Remediation\n\nSet `internal` attribute to `true`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-65","shortDescription":{"text":"Encryption at rest is not supported by instance type"},"fullDescription":{"text":"The instance type does not support encryption at rest"},"help":{"markdown":"## Overview\nThe instance type does not support encryption at rest\n\n## Impact\n\nThat should someone gain unauthorized access to the data they would be able to read the contents.\n\n## Remediation\n\nSet `cluster_config.instance_type` attribute to supported instance type e.g. `c5.large.elasticsearch`, and set `encrypt_at_rest.enabled` attribute to `true`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-66","shortDescription":{"text":"Node-to-node encryption is disabled"},"fullDescription":{"text":"The inter-cluster traffic will not be encrypted in transit"},"help":{"markdown":"## Overview\nThe inter-cluster traffic will not be encrypted in transit\n\n## Impact\n\nThe content could be intercepted and manipulated in transit\n\n## Remediation\n\nSet `node_to_node_encryption.enabled` attribute to `true`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-67","shortDescription":{"text":"Cluster does not enforce HTTPS"},"fullDescription":{"text":"The HTTPS is not enforced for elasticsearch cluster"},"help":{"markdown":"## Overview\nThe HTTPS is not enforced for elasticsearch cluster\n\n## Impact\n\nThe content could be intercepted and manipulated in transit\n\n## Remediation\n\nSet `domain_endpoint_options.enforce_https` attribute to `true`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-68","shortDescription":{"text":"Cluster does not enforce latest TLS/SSL policy"},"fullDescription":{"text":"The elasticsearch cluster will accept older TLS/SSL cipher suits"},"help":{"markdown":"## Overview\nThe elasticsearch cluster will accept older TLS/SSL cipher suits\n\n## Impact\n\nOlder cipher suites could be vulnerable to hijacking and information disclosure\n\n## Remediation\n\nSet `domain_endpoint_options.tls_security_policy` attribute to `Policy-Min-TLS-1-2-2019-07`","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-14","shortDescription":{"text":"KMS key does not have key rotation enabled"},"fullDescription":{"text":"That your encryption keys are not being rotated by AWS"},"help":{"markdown":"## Overview\nThat your encryption keys are not being rotated by AWS\n\n## Impact\n\nThat data is being encrypted with a key which is valid for a longer period of time, resulting in a greater exposure window should that key be leaked\n\n## Remediation\n\nAdding the `enable_key_rotation` attribute with a value of `true` to ensure your key is rotated","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}},{"id":"SNYK-CC-TF-18","shortDescription":{"text":"S3 Bucket is publically readable"},"fullDescription":{"text":"That this S3 bucket is publically readable without any authentication or authorization. "},"help":{"markdown":"## Overview\nThat this S3 bucket is publically readable without any authentication or authorization. \n\n## Impact\n\nThat you may be leaking sensitive information to members of the public without realizing.\n\n## Remediation\n\nAdding the `acl` attribute with a more restrictive policy such as `private` to restrict access.","text":""},"defaultConfiguration":{"level":"warning"},"properties":{"tags":["security","CWE-1032"]}}]}},"results":[{"ruleId":"SNYK-CC-TF-50","message":{"text":"Resource is publically accessible"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":21,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-53","message":{"text":"Non-Encrypted root block device"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":178,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-56","message":{"text":"Missing description"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":80,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-72","message":{"text":"Rule allows open egress"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":99,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-1","message":{"text":"Security Group allows open ingress"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":50,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-1","message":{"text":"Security Group allows open ingress"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":50,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-4","message":{"text":"Unencrypted S3 Bucket"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":171,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-45","message":{"text":"S3 server access logging is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":171,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-53","message":{"text":"Non-Encrypted root block device"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-73","message":{"text":"AWS Security Group allows open egress"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":70,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-61","message":{"text":"ECR image scanning is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-48","message":{"text":"Loadbalancer is internet facing"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":2,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-65","message":{"text":"Encryption at rest is not supported by instance type"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":6,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-66","message":{"text":"Node-to-node encryption is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-67","message":{"text":"Cluster does not enforce HTTPS"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-68","message":{"text":"Cluster does not enforce latest TLS/SSL policy"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-14","message":{"text":"KMS key does not have key rotation enabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-4","message":{"text":"Unencrypted S3 Bucket"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":55,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-4","message":{"text":"Unencrypted S3 Bucket"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":25,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-4","message":{"text":"Unencrypted S3 Bucket"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":39,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-4","message":{"text":"Unencrypted S3 Bucket"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-18","message":{"text":"S3 Bucket is publically readable"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":7,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-45","message":{"text":"S3 server access logging is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":25,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-45","message":{"text":"S3 server access logging is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":69,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-45","message":{"text":"S3 server access logging is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":39,"startColumn":0}}}]},{"ruleId":"SNYK-CC-TF-45","message":{"text":"S3 server access logging is disabled"},"locations":[{"physicalLocation":{"artifactLocation":{},"region":{"startLine":1,"startColumn":0}}}]}]}]}